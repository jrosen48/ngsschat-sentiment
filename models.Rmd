---
title: "Models"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
params:
  d: ""
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = TRUE, echo = FALSE)
```

```{r, renaming-params}
d <- params$d
```

# sentiment analysis technique: sentistrength

## null model

### results

```{r}
m_null <- lmer(senti_scale ~ 
                 
                 (1|state_master) +
                 
                 (1|screen_name), 
               
               data = d)

performance::icc(m_null, by_group = TRUE)

sjPlot::tab_model(m_null, show.icc = TRUE, show.ci = FALSE, show.se = TRUE)
extract_eq(m_null, wrap = TRUE)
```

## full model without state due to minimal ICC

### results

```{r}
m <- lmer(senti_scale ~ 
            
            type_of_tweet + # NGSSchat - chat, #NGSSChat non-chat, non-#NGSSchat (includes e.g. NGSS)
            #adopted +
            
            scale(time_on_twitter) + # for how long a person has been on Twitter
            isTeacher + # participant is a teacher or not
            
            year_of_post_centered +
            
            hasJoinedChat +
            
            scale(n_posted_chatsessions) + scale(n_posted_ngsschat_nonchat) + scale(n_posted_non_ngsschat) + # also user-level variables
            
            (1|screen_name), # varying slope of year of post within individuals
          
          data = d)

performance::icc(m, by_group = TRUE)
sjPlot::tab_model(m, show.icc = TRUE, show.ci = FALSE, show.se = TRUE)
extract_eq(m, wrap = TRUE)
```

```{r}
m_rs <- lmer(senti_scale ~ 
            
            type_of_tweet + # NGSSchat - chat, #NGSSChat non-chat, non-#NGSSchat (includes e.g. NGSS)
            #adopted +
            
            scale(time_on_twitter) + # for how long a person has been on Twitter
            isTeacher + # participant is a teacher or not
            
            year_of_post_centered +
            
            hasJoinedChat +
            
            scale(n_posted_chatsessions) + scale(n_posted_ngsschat_nonchat) + scale(n_posted_non_ngsschat) + # also user-level variables
            
            (year_of_post_centered |screen_name), # varying slope of year of post within individuals
          
          data = d)

performance::icc(m_rs, by_group = TRUE)
sjPlot::tab_model(m_rs, show.icc = TRUE, show.ci = FALSE, show.se = TRUE)
extract_eq(m_rs, wrap = TRUE)
```

with the tweet engagement measures at the tweet-level included

```{r}
m1 <- lmer(senti_scale ~ 
            
            favorite_count + retweet_count + reply_count + 
            
            type_of_tweet + # NGSSchat - chat, #NGSSChat non-chat, non-#NGSSchat (includes e.g. NGSS)
            #adopted +
            
            scale(time_on_twitter) + # for how long a person has been on Twitter
            isTeacher + # participant is a teacher or not
            
            year_of_post_centered +
            
            hasJoinedChat +
            
            scale(n_posted_chatsessions) + scale(n_posted_ngsschat_nonchat) + scale(n_posted_non_ngsschat) + # also user-level variables
            
            (year_of_post_centered |screen_name), # varying slope of year of post within individuals
          
          data = d)

performance::icc(m1, by_group = TRUE)
sjPlot::tab_model(m1, show.icc = TRUE, show.ci = FALSE, show.se = TRUE)
extract_eq(m1, wrap = TRUE)

anova(m_rs, m1)
```

with the tweet engagement measures at the user-level also included

```{r}
m2 <- lmer(senti_scale ~ 
            
            favorite_count_user + retweet_count_user +
            
            type_of_tweet + # NGSSchat - chat, #NGSSChat non-chat, non-#NGSSchat (includes e.g. NGSS)
            #adopted +
            
            scale(time_on_twitter) + # for how long a person has been on Twitter
            isTeacher + # participant is a teacher or not
            
            year_of_post_centered +
            
            hasJoinedChat +
            
            scale(n_posted_chatsessions) + scale(n_posted_ngsschat_nonchat) + scale(n_posted_non_ngsschat) + # also user-level variables
            
            (year_of_post_centered |screen_name), # varying slope of year of post within individuals
          
          data = d)

performance::icc(m2, by_group = TRUE)
sjPlot::tab_model(m2, show.icc = TRUE, show.ci = FALSE, show.se = TRUE)
extract_eq(m2, wrap = TRUE)

anova(m1, m2)
```
